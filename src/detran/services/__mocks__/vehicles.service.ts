import { Injectable } from '@nestjs/common';

// const builder = require('xmlbuilder');
// const parser = require('xml2json');

@Injectable()
export class VehiclesService {
  async searchVehicle ( plate, owner_document ) {

    const respostaVeiculoEncontrado = {
      ObterDadosVeiculoResult: {
        VeiculoInfo: {
          Veiculo: {
            Placa: 'VAL1705',
            CPF: 9876543210,
            Renavam: 10987654321,
          },
          Nome: 'JOSE SILVA',
          MarcaModelo: 'VW/PARATI 1.6 TRACKFIELD',
          AnoFabricacao: 2006,
        },
      },
    };

    const respostaVeiculoRoubado = {
      ObterDadosVeiculoResult: {
        MensagemErro: 'Consulta não permitida para veículo com registro de furto/roubo ativo',
      },
    };

    const respostaVeiculoNEncontrado = {
      ObterDadosVeiculoResult: {
        MensagemErro: 'Veículo não encontrado.',
      },
    };

    if ( plate === 'VAL1705' && owner_document === '9876543210' ) {
      return respostaVeiculoEncontrado;
    } else if ( plate === 'ROU8470' && owner_document === '12345678910' ) {
      return respostaVeiculoRoubado;
    } else {
      return respostaVeiculoNEncontrado;
    }
  }

  async getTickets ( plate, owner_document ): Promise<any> {

    const resposta = {
    };

    /*
Placa VAL1705
Document 9876543210
    {
"ObterDebitosResult": {
"Debito": {
"Debito": [
{
"DescricaoServico": "Postagem do CRLV 2018",
"ValorAtualizadoFranquia": "19.6400",
"DataVencimento": "2018-08-20T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 84677074,
"Placa": "VAL1705",
"IpvaExercicio": -1,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 2,
"LicenciamentoAnterior": -1,
"TaxaServico": -1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 27,
"Classe": 1,
"Exercicio": 2018,
"Parcela": 0,
"IpvaCotas": ""
},
{
"DescricaoServico": "Licenciamento Anual 2018",
"ValorAtualizadoFranquia": "157.0800",
"DataVencimento": "2018-08-20T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 84677073,
"Placa": "VAL1705",
"IpvaExercicio": -1,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": -1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 1,
"Classe": 1,
"Exercicio": 2018,
"Parcela": 0,
"IpvaCotas": ""
},
{
"DescricaoServico": "IPVA 4ª Cota 2018",
"ValorAtualizadoFranquia": "112.0500",
"DataVencimento": "2018-08-20T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 84677072,
"Placa": "VAL1705",
"IpvaExercicio": 0,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": -1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 129,
"Classe": 3,
"Exercicio": 2018,
"Parcela": 4,
"IpvaCotas": "20184"
},
{
"DescricaoServico": "IPVA 3ª Cota 2018",
"ValorAtualizadoFranquia": "112.9800",
"DataVencimento": "2018-07-18T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 84677071,
"Placa": "VAL1705",
"IpvaExercicio": 0,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": -1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 128,
"Classe": 3,
"Exercicio": 2018,
"Parcela": 3,
"IpvaCotas": "20183"
},
{
"DescricaoServico": "IPVA 2ª Cota 2018",
"ValorAtualizadoFranquia": "113.9000",
"DataVencimento": "2018-06-18T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 84677070,
"Placa": "VAL1705",
"IpvaExercicio": 0,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": -1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 10,
"Classe": 3,
"Exercicio": 2018,
"Parcela": 2,
"IpvaCotas": "20182"
},
{
"DescricaoServico": "IPVA 1ª Cota 2018",
"ValorAtualizadoFranquia": "114.8100",
"DataVencimento": "2018-05-18T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 84677069,
"Placa": "VAL1705",
"IpvaExercicio": 0,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": -1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 9,
"Classe": 3,
"Exercicio": 2018,
"Parcela": 1,
"IpvaCotas": "20181"
},
{
"DescricaoServico": "Seguro DPVAT 2018 Cota Única",
"ValorAtualizadoFranquia": "68.1000",
"DataVencimento": "2018-05-18T03:00:00.000Z",
"DpvatCotas": "20180",
"IdDebito": 84677067,
"Placa": "VAL1705",
"IpvaExercicio": -1,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": -1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": 0,
"DpvatAnterior": -1,
"CodigoServico": 3,
"Classe": 4,
"Exercicio": 2018,
"Parcela": 0,
"IpvaCotas": ""
},
{
"DescricaoServico": "IPVA 4ª Cota 2017",
"ValorAtualizadoFranquia": "327.9200",
"DataVencimento": "2017-08-15T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 78994718,
"Placa": "VAL1705",
"IpvaExercicio": 1,
"IpvaAnterior": 1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": 1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 129,
"Classe": 3,
"Exercicio": 2017,
"Parcela": 4,
"IpvaCotas": "20174"
},
{
"DescricaoServico": "Postagem do CRLV 2017",
"ValorAtualizadoFranquia": "19.6400",
"DataVencimento": "2017-08-15T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 78994386,
"Placa": "VAL1705",
"IpvaExercicio": -1,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 3,
"LicenciamentoAnterior": 2,
"TaxaServico": -1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 27,
"Classe": 1,
"Exercicio": 2017,
"Parcela": 0,
"IpvaCotas": ""
},
{
"DescricaoServico": "Licenciamento Anual 2017",
"ValorAtualizadoFranquia": "157.0800",
"DataVencimento": "2017-08-15T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 78994385,
"Placa": "VAL1705",
"IpvaExercicio": -1,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": 1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 1,
"Classe": 1,
"Exercicio": 2017,
"Parcela": 0,
"IpvaCotas": ""
},
{
"DescricaoServico": "IPVA 3ª Cota 2017",
"ValorAtualizadoFranquia": "328.8500",
"DataVencimento": "2017-07-13T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 78994720,
"Placa": "VAL1705",
"IpvaExercicio": 1,
"IpvaAnterior": 1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": 1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 128,
"Classe": 3,
"Exercicio": 2017,
"Parcela": 3,
"IpvaCotas": "20173"
},
{
"DescricaoServico": "IPVA 2ª Cota 2017",
"ValorAtualizadoFranquia": "329.7300",
"DataVencimento": "2017-06-13T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 78994722,
"Placa": "VAL1705",
"IpvaExercicio": 1,
"IpvaAnterior": 1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": 1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 10,
"Classe": 3,
"Exercicio": 2017,
"Parcela": 2,
"IpvaCotas": "20172"
},
{
"DescricaoServico": "IPVA 1ª Cota 2017",
"ValorAtualizadoFranquia": "330.6000",
"DataVencimento": "2017-05-11T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 78994724,
"Placa": "VAL1705",
"IpvaExercicio": 1,
"IpvaAnterior": 1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": 1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 9,
"Classe": 3,
"Exercicio": 2017,
"Parcela": 1,
"IpvaCotas": "20171"
},
{
"DescricaoServico": "Seguro DPVAT 2017 Cota Única",
"ValorAtualizadoFranquia": "101.1600",
"DataVencimento": "2017-05-11T03:00:00.000Z",
"DpvatCotas": "20170",
"IdDebito": 78994379,
"Placa": "VAL1705",
"IpvaExercicio": -1,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": 1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": 1,
"DpvatAnterior": 1,
"CodigoServico": 3,
"Classe": 4,
"Exercicio": 2017,
"Parcela": 0,
"IpvaCotas": ""
},
{
"DescricaoServico": "Autorizacao para Vistoria Prévia 2016",
"ValorAtualizadoFranquia": "59.0800",
"DataVencimento": "2016-11-23T02:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 64755888,
"Placa": "VAL1705",
"IpvaExercicio": -1,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": 1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 55,
"Classe": 2,
"Exercicio": 2016,
"Parcela": 0,
"IpvaCotas": ""
},
{
"DescricaoServico": "Licenciamento Anual 2016",
"ValorAtualizadoFranquia": "157.0800",
"DataVencimento": "2016-09-26T03:00:00.000Z",
"DpvatCotas": "",
"IdDebito": 62191552,
"Placa": "VAL1705",
"IpvaExercicio": -1,
"IpvaAnterior": -1,
"LicenciamentoExercicio": 1,
"LicenciamentoAnterior": 1,
"TaxaServico": 1,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": -1,
"CodigoServico": 1,
"Classe": 1,
"Exercicio": 2016,
"Parcela": 0,
"IpvaCotas": ""
},
{
"DescricaoServico": "Seguro DPVAT 2016 Cota Única",
"ValorAtualizadoFranquia": "101.1600",
"DataVencimento": "2016-05-12T03:00:00.000Z",
"DpvatCotas": "20160",
"IdDebito": 62191554,
"Placa": "VAL1705",
"IpvaExercicio": -1,
"IpvaAnterior": -1,
"LicenciamentoExercicio": -1,
"LicenciamentoAnterior": 1,
"TaxaServico": 2,
"Multas": -1,
"IpvaParcelamento": -1,
"TaxaEspecial": -1,
"TaxaPatio": -1,
"DpvatExercicio": -1,
"DpvatAnterior": 1,
"CodigoServico": 3,
"Classe": 4,
"Exercicio": 2016,
"Parcela": 0,
"IpvaCotas": ""
}
]
}
},

Placa XXX0000
Document 12345678910

{
"ObterDebitosResult": {
"Debito": null
},
"_rawResponse": "<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"><soap:Body><ObterDebitosResponse xmlns=\"http://tempuri.org/\"><ObterDebitosResult><Debito /></ObterDebitosResult></ObterDebitosResponse></soap:Body></soap:Envelope>"
}
*/

    return resposta;
  }
}
